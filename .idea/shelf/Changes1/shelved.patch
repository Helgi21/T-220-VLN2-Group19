Index: auction/views.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.contrib.auth.mixins import LoginRequiredMixin\r\nfrom django.http import HttpResponse\r\nfrom django.shortcuts import render, redirect, get_object_or_404\r\nfrom django.views import View\r\nfrom django.views.generic import DetailView, ListView\r\nfrom . import models\r\nfrom .forms.add_auction_form import AddAuctionForm\r\nfrom .forms.make_offer_form import MakeOfferForm\r\nfrom .forms.make_counter_offer_form import MakeCounterOfferForm\r\nfrom django.contrib import messages\r\n\r\nfrom django.http import Http404\r\n\r\n\r\n# Create your views here.\r\n\r\n\r\nclass AllAuctions(ListView):\r\n    template_name = 'auction/auctions.html'\r\n    model = models.Auction\r\n\r\n\r\nclass SingleAuction(DetailView):\r\n    queryset = models.Auction.objects.all()\r\n    template_name = 'auction/single_auction.html'\r\n\r\n    def get_object(self, **kwargs):\r\n        obj = super().get_object()\r\n        return obj\r\n\r\n    def get_context_data(self, **kwargs):\r\n        form = MakeOfferForm()\r\n        context = super().get_context_data(**kwargs)\r\n        context['form'] = form\r\n        return context\r\n\r\n    def post(self, request, pk):\r\n        form = MakeOfferForm(data=request.POST)\r\n        if form.is_valid():\r\n            offer_obj = models.Offer()\r\n            offer_obj.price = form.cleaned_data.get('price')\r\n            offer_obj.auction = models.Auction.objects.get(id=pk)\r\n            offer_obj.user = request.user\r\n            offer_obj.status = 1\r\n            offer_obj.save()\r\n\r\n            messages.success(request, 'Offer sent!')\r\n\r\n            return redirect(f'/{pk}/')\r\n\r\n\r\nclass AddAuction(LoginRequiredMixin, View):\r\n    def get(self, request):\r\n        form = AddAuctionForm()\r\n        return render(request, 'auction/add_auction.html', {\r\n            'form': form\r\n        })\r\n\r\n    def post(self, request):\r\n        form = AddAuctionForm(data=request.POST)\r\n        if form.is_valid():\r\n            auction_obj = models.Auction()\r\n            auction_obj.user = request.user\r\n            auction_obj.title = form.cleaned_data['title']\r\n            auction_obj.description = form.cleaned_data['description']\r\n            auction_obj.price = form.cleaned_data['price']\r\n            auction_obj.loc = form.cleaned_data.get('loc')\r\n            auction_obj.cat = form.cleaned_data.get('cat')\r\n\r\n            image_obj = models.Image()\r\n            image_obj.link = form.cleaned_data['image']\r\n            image_obj.auction = auction_obj\r\n\r\n            auction_obj.save()\r\n            image_obj.save()\r\n\r\n            # TAGS DISCONTINUED FOR NOW - NOT IMPORTANT\r\n            # for word in form.cleaned_data['tags'].split(\" \"):\r\n            # tag_obj = models.Tag()\r\n            # tag_obj.name\r\n            # tag_obj.save()\r\n            return redirect('/')\r\n\r\n\r\nclass ViewOffers(LoginRequiredMixin, ListView):\r\n    template_name = 'auction/offers.html'\r\n    # paginate_by = 100\r\n    model = models.Offer\r\n\r\n    def get_queryset(self):\r\n        qs = super().get_queryset()\r\n        return qs.filter(user=self.request.user).exclude(status=5).exclude(status=2)\r\n\r\n    def get_context_data(self, *args):\r\n        context = super().get_context_data()\r\n        context['received_offers'] = models.Offer.objects.all().filter(auction__user=self.request.user) \\\r\n            .exclude(status__in=[5, 2])\r\n        q2 = models.Offer.objects.all().filter(user=self.request.user).filter(status=2)\r\n\r\n        context['received_offers'] = context['received_offers'].union(q2)\r\n        return context\r\n\r\n    def post(self, request):\r\n        if 'counter_offer_id' in request.POST:  # Counter offer only\r\n            print(\"in if\")\r\n            offer_id = request.POST['counter_offer_id']\r\n            print(offer_id)\r\n            offer_price = request.POST['counter_offer_price']\r\n\r\n            offer = models.Offer.objects.get(id=offer_id)\r\n\r\n            offer.price = offer_price\r\n            offer.status = 2\r\n            print(offer.auction.title)\r\n\r\n            offer.save()\r\n            messages.success(request, f'Counter offer sent!')\r\n\r\n            return redirect(f'/offers/?received_offers')\r\n\r\n        else:  # Accept or decline only\r\n            offer_response = request.POST['offer_response'].split('_')\r\n\r\n            offer = models.Offer.objects.get(id=offer_response[1])\r\n            offer.status = offer_response[0]\r\n\r\n            offer.save()\r\n\r\n            if offer_response == 5:\r\n                messages.success(request, f'Offer accepted!')\r\n            elif offer_response == 4:\r\n                messages.success(request, f'Offer declined!')\r\n\r\n            return redirect(f'/offers/?received_offers')\r\n\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/auction/views.py b/auction/views.py
--- a/auction/views.py	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/auction/views.py	(date 1651893787238)
@@ -19,6 +19,9 @@
     template_name = 'auction/auctions.html'
     model = models.Auction
 
+    def get(self, request, *args, **kwargs):
+        pass
+
 
 class SingleAuction(DetailView):
     queryset = models.Auction.objects.all()
Index: fire_sale/urls.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\"\"\"fire_sale URL Configuration\r\n\r\nThe `urlpatterns` list routes URLs to views. For more information please see:\r\n    https://docs.djangoproject.com/en/4.0/topics/http/urls/\r\nExamples:\r\nFunction views\r\n    1. Add an import:  from my_app import views\r\n    2. Add a URL to urlpatterns:  path('', views.home, name='home')\r\nClass-based views\r\n    1. Add an import:  from other_app.views import Home\r\n    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')\r\nIncluding another URLconf\r\n    1. Import the include() function: from django.urls import include, path\r\n    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))\r\n\"\"\"\r\nfrom django.contrib import admin\r\nfrom django.urls import path, include\r\n\r\nurlpatterns = [\r\n    path('admin/', admin.site.urls),\r\n    path('', include('user.urls')),\r\n    path('', include('auction.urls')),\r\n    path('manage/', include('administrator.urls'))\r\n]\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/fire_sale/urls.py b/fire_sale/urls.py
--- a/fire_sale/urls.py	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/fire_sale/urls.py	(date 1651893787248)
@@ -20,5 +20,5 @@
     path('admin/', admin.site.urls),
     path('', include('user.urls')),
     path('', include('auction.urls')),
-    path('manage/', include('administrator.urls'))
+    path('manage/', include('administrator.urls'), name="manage")
 ]
Index: templates/auction/auctions.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends 'base.html' %}\r\n{% block content %}\r\n    <h2>Auctions!</h2>\r\n    <a href=\"/add_auction\" class=\"btn btn-info\" role=\"button\">Add Auction</a>\r\n    {% for auction in object_list %}\r\n        <style>\r\n            main div{\r\n                border: 2px solid gray;\r\n                margin: 5px auto;\r\n                padding: 5px;\r\n                width: 800px;\r\n            }\r\n            main img{\r\n                width: 790px;\r\n                height: 250px;\r\n            }\r\n        </style>\r\n        <a href=\"/{{ auction.id }}\">\r\n            <div class=\"well\">\r\n                {% for img in auction.images.all %}\r\n                    <img src=\"{{ img.link }}\">\r\n                {% endfor %}\r\n                <h3>{{ auction.title }}</h3>\r\n            </div>\r\n        </a>\r\n    {% endfor %}\r\n\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/auction/auctions.html b/templates/auction/auctions.html
--- a/templates/auction/auctions.html	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/templates/auction/auctions.html	(date 1651893787288)
@@ -1,7 +1,7 @@
 {% extends 'base.html' %}
 {% block content %}
     <h2>Auctions!</h2>
-    <a href="/add_auction" class="btn btn-info" role="button">Add Auction</a>
+    <a href="{% url 'add_auction' %}" class="btn btn-info" role="button">Add Auction</a>
     {% for auction in object_list %}
         <style>
             main div{
@@ -15,7 +15,7 @@
                 height: 250px;
             }
         </style>
-        <a href="/{{ auction.id }}">
+        <a href="{% url 'single_auction' pk=auction.id %}">
             <div class="well">
                 {% for img in auction.images.all %}
                     <img src="{{ img.link }}">
Index: user/urls.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>from django.contrib.auth.views import LoginView, LogoutView\r\nfrom django.urls import path\r\nfrom . import views\r\n\r\nurlpatterns = [\r\n    path('profile/', views.UserProfile.as_view(), name=\"auctions\"),\r\n    path('profile/<int:pk>/', views.Profile.as_view(), name=\"profile\"),\r\n    # path('profile/<int:pk>/payment_options/', views.PaymentOptions.as_view(), name=\"payment_options\"),\r\n    path('purchases/', views.Purchases.as_view(), name=\"purchases\"),\r\n    path('sales/', views.Sales.as_view(), name=\"sales\"),\r\n    path('register/', views.Register.as_view(), name=\"register\"),\r\n    path('login/', views.Login.as_view(), name=\"login\"),\r\n    path('logout/', LogoutView.as_view(next_page=\"login\"), name=\"logout\"),\r\n    path('report/', views.Report.as_view(), name=\"report\"),\r\n    path('pay/', views.Pay.as_view(), name=\"pay\")\r\n]\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/user/urls.py b/user/urls.py
--- a/user/urls.py	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/user/urls.py	(date 1651893787296)
@@ -3,7 +3,7 @@
 from . import views
 
 urlpatterns = [
-    path('profile/', views.UserProfile.as_view(), name="auctions"),
+    path('profile/', views.UserProfile.as_view(), name="user_profile"),
     path('profile/<int:pk>/', views.Profile.as_view(), name="profile"),
     # path('profile/<int:pk>/payment_options/', views.PaymentOptions.as_view(), name="payment_options"),
     path('purchases/', views.Purchases.as_view(), name="purchases"),
Index: templates/auction/single_auction.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{% extends \"base.html\" %}\r\n{% block content %}\r\n    {% for image in auction.images.all %}\r\n        <img src=\"{{ image.link }}\">\r\n    {% endfor %}\r\n\r\n    <h1>{{ auction.title }}</h1>\r\n    <p>{{ auction.description }}</p>\r\n    <h4>{{ auction.price }}kr </h4>\r\n    <p>\r\n        <span> Seller: {{ auction.user.username }} </span>\r\n        <span>Location: {{ auction.loc.name }} </span>\r\n        <span>Category: {{ auction.cat.name }} </span>\r\n    </p>\r\n\r\n    <!-- Make offer button -->\r\n    <button type=\"button\" class=\"btn btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#offerModal\">\r\n        Make offer\r\n    </button>\r\n    <!-- Make offer Modal -->\r\n    <div class=\"modal fade\" id=\"offerModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"offerModalLabel\"\r\n         aria-hidden=\"true\">\r\n        <div class=\"modal-dialog\" role=\"document\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <h5 class=\"modal-title\" id=\"offerModalLabel\">Make Offer</h5>\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" data-bs-toggle=\"modal\"\r\n                            data-bs-target=\"#offerModal\">\r\n                        <span aria-hidden=\"true\">&times;</span>\r\n                    </button>\r\n                </div>\r\n                <div class=\"modal-body\">\r\n                    <form class=\"form-horizontal\" action=\"/{{ auction.id }}/\" method=\"post\">\r\n                        {% csrf_token %}\r\n                        {{ form }}\r\n                        <input type=\"submit\" value=\"Send\" class=\"btn btn-primary pull-right\"\r\n                               style=\"clear:both; margin: 10px 0\">\r\n                    </form>\r\n                 </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/auction/single_auction.html b/templates/auction/single_auction.html
--- a/templates/auction/single_auction.html	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/templates/auction/single_auction.html	(date 1651893787305)
@@ -30,7 +30,7 @@
                     </button>
                 </div>
                 <div class="modal-body">
-                    <form class="form-horizontal" action="/{{ auction.id }}/" method="post">
+                    <form class="form-horizontal" action="{% url 'single_auction' pk=auction.id %}" method="post">
                         {% csrf_token %}
                         {{ form }}
                         <input type="submit" value="Send" class="btn btn-primary pull-right"
Index: templates/navbar.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><nav class=\"navbar navbar-expand-lg navbar-default fixed-top navbar-dark\" style=\"background-color: #3c3d41;\" id=\"mainNav\">\r\n      <div class=\"container\">\r\n          <a class=\"navbar-brand\" href=\"/\" style=\"color:white; font-size: 160%;\">Fire Sale!</a>\r\n\r\n          <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#notificationNavbar #profileNavbarDropdown #signinNavbar\" aria-controls=\"navbarNavDarkDropdown\" aria-expanded=\"false\" aria-label=\"Toggle navigation\" style=\"float: right;\">\r\n            <span class=\"navbar-toggler-icon\"></span>\r\n          </button>\r\n\r\n          {% if request.user.is_authenticated %}\r\n          <div style=\"float: right; margin-left: 70%\">\r\n              <div class=\"collapse navbar-collapse\" id=\"notificationNavbar\">\r\n                <ul class=\"navbar-nav\">\r\n                    <li class=\"nav-item\">\r\n                        <span class=\"badge badge-pill badge-warning\" style=\"float:right;margin-bottom:-15px;margin-right:-12px;font-size:10px\">0</span>\r\n                        <a class=\"nav-link\" href=\"\">Notifications</a>\r\n                    </li>\r\n                </ul>\r\n              </div>\r\n          </div>\r\n          {% endif %}\r\n\r\n          <div style=\"float:right; margin-right: 0%; margin-left: 20px;\">\r\n          {% if request.user.is_authenticated %}\r\n              <div class=\"collapse navbar-collapse\" id=\"profileNavbarDropdown\">\r\n                  <ul class=\"navbar-nav\">\r\n                    <li class=\"nav-item dropdown\">\r\n                      <a class=\"nav-link dropdown-toggle\" href=\"\" id=\"navbarDarkDropdownMenuLink\" role=\"button\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\r\n                          {{ request.user.username }}\r\n                      </a>\r\n                      <ul class=\"dropdown-menu dropdown-menu-dark\" aria-labelledby=\"navbarDarkDropdownMenuLink\">\r\n                          <li><a class=\"dropdown-item\" href=\"/profile/\">Profile</a></li>\r\n                          <li><a class=\"dropdown-item\" href=\"/offers\">Offers</a></li>\r\n                          <li><a class=\"dropdown-item\" href=\"/sales/\">Sales</a></li>\r\n                          <li><a class=\"dropdown-item\" href=\"/purchases/\">Purchases</a></li>\r\n                          {% if request.user.is_superuser %}\r\n                              <li><a class=\"dropdown-item\" href=\"#\">Manage</a></li>\r\n                          {% endif %}\r\n                          <li><a class=\"dropdown-item\" href=\"/logout/\">Log Out</a></li>\r\n                          <li><a class=\"dropdown-item\" href=\"/report/\">Report</a></li>\r\n                      </ul>\r\n                    </li>\r\n                  </ul>\r\n              </div>\r\n          {% else %}\r\n              <div class=\"collapse navbar-collapse\" id=\"signinNavbar\">\r\n                <ul class=\"navbar-nav\">\r\n                    <li class=\"nav-item\">\r\n                        <a href=\"login/\" class=\"nav-item nav-link\" id=\"sign-in-btn\">Log In</a>\r\n                    </li>\r\n                </ul>\r\n              </div>\r\n          {% endif %}\r\n          </div>\r\n      </div>\r\n    </nav>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/navbar.html b/templates/navbar.html
--- a/templates/navbar.html	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/templates/navbar.html	(date 1651893787268)
@@ -28,15 +28,15 @@
                           {{ request.user.username }}
                       </a>
                       <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
-                          <li><a class="dropdown-item" href="/profile/">Profile</a></li>
-                          <li><a class="dropdown-item" href="/offers">Offers</a></li>
-                          <li><a class="dropdown-item" href="/sales/">Sales</a></li>
-                          <li><a class="dropdown-item" href="/purchases/">Purchases</a></li>
+                          <li><a class="dropdown-item" href="{% url 'user_profile' %}">Profile</a></li>
+                          <li><a class="dropdown-item" href="{% url 'offers' %}">Offers</a></li>
+                          <li><a class="dropdown-item" href="{% url 'sales' %}">Sales</a></li>
+                          <li><a class="dropdown-item" href="{% url 'purchases' %}">Purchases</a></li>
                           {% if request.user.is_superuser %}
                               <li><a class="dropdown-item" href="#">Manage</a></li>
                           {% endif %}
-                          <li><a class="dropdown-item" href="/logout/">Log Out</a></li>
-                          <li><a class="dropdown-item" href="/report/">Report</a></li>
+                          <li><a class="dropdown-item" href="{% url 'logout' %}">Log Out</a></li>
+                          <li><a class="dropdown-item" href="{% url 'report' %}">Report</a></li>
                       </ul>
                     </li>
                   </ul>
@@ -45,7 +45,7 @@
               <div class="collapse navbar-collapse" id="signinNavbar">
                 <ul class="navbar-nav">
                     <li class="nav-item">
-                        <a href="login/" class="nav-item nav-link" id="sign-in-btn">Log In</a>
+                        <a href="{% url 'login' %}" class="nav-item nav-link" id="sign-in-btn">Log In</a>
                     </li>
                 </ul>
               </div>
Index: templates/user/profile_edit.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><div id=\"profile_edit\">\r\n    <form method=\"post\" action=\"/profile/{{request.user.id}}/\" name=\"profile_edit\" class=\"form form-horizontal\">\r\n        {% csrf_token %}\r\n        {{ edit_user_form }}\r\n        <input type=\"submit\" value=\"Update\" class=\"btn btn-primary pull-right\">\r\n    </form>\r\n</div>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/templates/user/profile_edit.html b/templates/user/profile_edit.html
--- a/templates/user/profile_edit.html	(revision 5a8a43f73cde983b308838d53de5860fcae2d755)
+++ b/templates/user/profile_edit.html	(date 1651893787227)
@@ -1,5 +1,5 @@
 <div id="profile_edit">
-    <form method="post" action="/profile/{{request.user.id}}/" name="profile_edit" class="form form-horizontal">
+    <form method="post" action="{% url 'profile' pk=request.user.id %}" name="profile_edit" class="form form-horizontal">
         {% csrf_token %}
         {{ edit_user_form }}
         <input type="submit" value="Update" class="btn btn-primary pull-right">
